test:
  helpers:
    # Regex Extractions from STDOUT
    regex_helpers:
      project: &get_project_from_output
        variable: project
        pattern: projects/([\w-]+)
      location: &get_location_from_output
        variable: location
        pattern: locations/([\w-]+)
      entry_group_id: &get_entry_group_id_from_output
        variable: entry_group_id
        pattern: entryGroups/@([\w-]+)
      entry_id: &get_entry_id_from_output
        variable: entry_id
        pattern: entries/([\w-]+)
  suites:
  - name: Data Catalog v1beta1 Get Entry sample tests
    setup:
    - call:
        sample: data_catalog_lookup_entry
        params:
          resource_name:
            literal: //bigquery.googleapis.com/projects/bigquery-public-data/datasets/new_york_taxi_trips/tables/taxi_zone_geom
    - extract_match: *get_project_from_output
    - extract_match: *get_location_from_output
    - extract_match: *get_entry_group_id_from_output
    - extract_match: *get_entry_id_from_output
    cases:
    - name: Get Entry for a public BigQuery Table
      spec:
      - call:
          sample: data_catalog_get_entry
          params:
            project:
              variable: project
            location:
              variable: location
            entry_group_id:
              variable: entry_group_id
            entry_id:
              variable: entry_id
      - assert_contains:
        - literal: "Entry name: projects/bigquery-public-data"
        - literal: "Entry type: TABLE"
        - literal: "Linked resource: //bigquery.googleapis.com/projects/bigquery-public-data/datasets/new_york_taxi_trips/tables/taxi_zone_geom"
